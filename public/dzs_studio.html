<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DZS Script Studio</title>
    <style>
      :root{
        --bg: #0d0f12;
        --panel: rgba(20,20,26,0.7);
        --panel-2: rgba(10,10,14,0.7);
        --border: rgba(255,255,255,0.08);
        --text: #f3f3f3;
        --muted: rgba(255,255,255,0.6);
        --accent: #f6b24d;
        --danger: #ff9060;
        --ok: #70d28c;
        --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono";
      }
      *{ box-sizing: border-box; }
      body{
        margin: 0;
        color: var(--text);
        background: radial-gradient(1200px 600px at 20% -10%, #1b1f2a, #0c0d12 60%);
        font-family: "Trebuchet MS", "Segoe UI", sans-serif;
      }
      header{
        padding: 16px 20px 12px 20px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.2));
      }
      .title{
        font-weight: 900;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-size: 16px;
      }
      .header-row{
        display: flex;
        flex-wrap: wrap;
        gap: 12px 20px;
        align-items: center;
        margin-top: 10px;
      }
      .field{
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 12px;
        color: var(--muted);
      }
      .field input{
        background: rgba(0,0,0,0.35);
        border: 1px solid var(--border);
        color: var(--text);
        padding: 6px 8px;
        border-radius: 8px;
        font-family: var(--mono);
        font-size: 12px;
        width: 160px;
      }
      .status{
        font-size: 12px;
        color: var(--muted);
      }
      .btn{
        border: 1px solid rgba(255,255,255,0.1);
        background: rgba(0,0,0,0.4);
        color: var(--text);
        padding: 7px 12px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 700;
        letter-spacing: 0.02em;
      }
      .btn.primary{
        background: rgba(246,178,77,0.18);
        border-color: rgba(246,178,77,0.5);
      }
      .btn:disabled{
        opacity: 0.5;
        cursor: not-allowed;
      }
      main{
        padding: 14px 16px;
        display: grid;
        grid-template-rows: 1fr 180px;
        gap: 12px;
        height: calc(100vh - 84px);
      }
      .grid{
        display: grid;
        grid-template-columns: 280px 1fr 320px;
        gap: 12px;
        min-height: 0;
      }
      .card{
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 10px 12px;
        min-height: 0;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .section-title{
        font-weight: 900;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-size: 11px;
        opacity: 0.9;
      }
      .list{
        overflow: auto;
        min-height: 0;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .row{
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .library-item{
        background: var(--panel-2);
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 8px 10px;
        cursor: pointer;
      }
      .library-item h4{
        margin: 0;
        font-size: 13px;
        font-weight: 900;
      }
      .library-item p{
        margin: 4px 0 0 0;
        font-size: 12px;
        color: var(--muted);
      }
      .badge{
        padding: 4px 6px;
        border-radius: 8px;
        font-size: 11px;
        font-weight: 800;
        border: 1px solid var(--border);
      }
      .badge.ok{ border-color: rgba(112,210,140,0.6); color: var(--ok); }
      .badge.off{ border-color: rgba(255,144,96,0.6); color: var(--danger); }
      #editor{
        flex: 1;
        min-height: 0;
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid var(--border);
      }
      #problems, #output{
        overflow: auto;
        min-height: 0;
        font-size: 12px;
        color: var(--muted);
        font-family: var(--mono);
      }
      .mono{
        font-family: var(--mono);
      }
      @media (max-width: 1100px){
        main{ height: auto; }
        .grid{ grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="title">DZS Script Studio</div>
      <div class="header-row">
        <label class="field">Match ID <input id="matchId" placeholder="match id" /></label>
        <label class="field">Client ID <input id="clientId" placeholder="client id" /></label>
        <div class="status" id="statusLine">Status: unknown</div>
        <button class="btn" id="refreshBtn">Refresh</button>
      </div>
    </header>
    <main>
      <div class="grid">
        <section class="card">
          <div class="section-title">Library</div>
          <input class="mono" id="librarySearch" placeholder="Search scripts" />
          <div class="list" id="libraryList"></div>
        </section>
        <section class="card">
          <div class="section-title">Editor</div>
          <div class="row">
            <div class="mono" id="fileLabel">untitled.dzs</div>
            <div style="flex:1"></div>
            <button class="btn" id="validateBtn">Validate</button>
            <button class="btn primary" id="injectBtn">Inject/Enable</button>
            <button class="btn" id="downloadBtn">Download .dzs</button>
            <button class="btn" id="importBtn">Import .dzs</button>
          </div>
          <div class="status" id="hostHint">Host-only actions require lobby + host.</div>
          <div id="editor"></div>
          <input type="file" id="fileInput" accept=".dzs" style="display:none" />
        </section>
        <section class="card">
          <div class="section-title">Installed</div>
          <div class="list" id="installedList"></div>
        </section>
      </div>
      <div class="card" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        <div style="display:flex;flex-direction:column;gap:6px;min-height:0;">
          <div class="section-title">Problems</div>
          <div id="problems"></div>
        </div>
        <div style="display:flex;flex-direction:column;gap:6px;min-height:0;">
          <div class="section-title">Output</div>
          <div id="output"></div>
        </div>
      </div>
    </main>
    <script type="module" src="/public/dzs_studio.js"></script>
  </body>
</html>
